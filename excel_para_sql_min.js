function ExcelParaSQL(obj){let _campos=new Array,contagem=function(e,o,r,t,a){void 0===a&&(a=0);let n="",s=0,c=0;for(let t=0;t<e.length;t++)switch(e.substring(t,t+1)){case o:s++;break;case r:c++}return s!=c+a&&(n=t),n},like=function(e,o){let r=new Array;return e.forEach((e=>{if(e.indexOf("=")>-1){let t=e.split("=");null!=o?o.indexOf(t[0].trim())>-1?r.push(t[0]+" LIKE '%"+t[1]+"%'"):console.warn('O campo "'+t[0]+'" não foi encontrado e foi removido'):r.push(t[0]+" LIKE '%"+t[1]+"%'")}else r.push(e)})),r},eColuna=function(e){if(!e||"string"!=typeof e)return!1;if(e=e.trim(),!/^[a-zA-Z_$]/.test(e))return!1;for(let o=1;o<e.length;o++)if(!/^[a-zA-Z0-9_$]/.test(e[o]))return!1;return!0};if(this.e=function(e,o){return void 0===o&&(o=e,e=null),"("+like(o,e).join(" AND ")+")"},this.ou=function(e,o){return void 0===o&&(o=e,e=null),"("+like(o,e).join(" OR ")+")"},this.nao=function(e,o){return void 0===o&&(o=e,e=null),"NOT("+like([o],e)[0]+")"},void 0!==obj){let separador=",",erro="",retorno=!1,_campos_ret=new Array;if("object"==typeof obj){let e="",o=!1;for(x in obj)-1==["conteudo","separador","campos"].indexOf(x)&&(e='A chave "'+x+'" não é conhecida');e&&console.warn(e),"string"!=typeof obj.conteudo&&(erro='A chave "conteúdo" deve ser uma string'),(-1==["undefined","string"].indexOf(typeof obj.separador)||"string"==typeof obj.separador&&1!=obj.separador.length)&&(o=!0),erro||(o?erro='A chave "separador", se declarada, deve ser uma string de tamanho 1':void 0!==obj.separador&&(separador=obj.separador)),erro||(-1==["undefined","object"].indexOf(typeof obj.campos)?o=!0:"object"==typeof obj.campos&&obj.campos.forEach((e=>{"string"==typeof e&&eColuna(e)||(o=!0)})),o?erro='A chave "campos", se declarada, deve ser um array de colunas SQL':void 0!==obj.campos&&(_campos=obj.campos))}else erro="Parâmetro não declarado corretamente";if(!erro){var texto=obj.conteudo.toLowerCase();if(","!=separador)for(;texto.indexOf(separador)>-1;)texto=texto.replace(separador,",");const e=texto.indexOf("e(")>-1||texto.indexOf("ou(")>-1||texto.indexOf("nao(")>-1;var pseudocodigo=e||texto.indexOf(",")>-1||texto.indexOf("=")>-1;e&&(erro=contagem(texto,"(",")","Número desigual de parênteses"),erro||(erro=contagem(texto,"=",",","Termos não declarados corretamente",1)))}if(!erro){texto=texto.replace(/\(/g,"(['").replace(/\)/g,"'])").replace(/,/g,"','");const substituir={",'(['":",","'ou([":"ou(['","'e([":"e(['","'nao([":"nao(['","])'":"])","'ou":"ou","'e":"e","'nao":"nao","''":"'"," ":""};for(x in substituir)for(;texto.indexOf(x)>-1;)texto=texto.replace(x,substituir[x]);texto=texto.replace(/e\(/g,"new ExcelParaSQL().e(").replace(/ou\(/g,"new ExcelParaSQL().ou(").replace(/nao\(/g,"new ExcelParaSQL().nao(");try{let texto_formatado=eval(texto),poss_col=new Array;texto.split("=").forEach((e=>{(e=e.split("[")).forEach((e=>{poss_col.push(e)}))})),poss_col.forEach((e=>{if(e.indexOf("'")>-1){let o=e.split("'");o=o[o.length-1],eColuna(o)&&(_campos.indexOf(o)>-1||!_campos.length)&&_campos_ret.push(o)}})),texto=eval(texto.replace(/e\(/g,"e(['"+_campos_ret.join("','")+"'],").replace(/ou\(/g,"ou(['"+_campos_ret.join("','")+"'],").replace(/nao\(/g,"nao(['"+_campos_ret.join("','")+"'],"))}catch(e){if(!pseudocodigo&&_campos.length){for(;texto.indexOf("'")>-1;)texto=texto.replace("'","");let e=new Array;_campos.forEach((o=>{e.push(o+" LIKE '%"+texto+"%'")})),texto=e.join(" OR "),_campos_ret=_campos}else erro="Erro desconhecido"}}return erro?console.error(erro):retorno={sql:texto,campos:_campos_ret},retorno}}