function ExcelParaSQL(obj){let campos=new Array,contagem=function(e,o,r,t,a){void 0===a&&(a=0);let n="",c=0,s=0;for(let t=0;t<e.length;t++)switch(e.substring(t,t+1)){case o:c++;break;case r:s++}return c!=s+a&&(n=t),n},like=function(e){let o=new Array;return e.forEach((e=>{if(e.indexOf("=")>-1){let r=e.split("=");(campos.indexOf(r[0].trim())>-1||!campos.length)&&o.push(r[0]+" LIKE '%"+r[1]+"%'")}else o.push(e)})),o},eColuna=function(e){if(!e||"string"!=typeof e)return!1;if(e=e.trim(),!/^[a-zA-Z_$]/.test(e))return!1;for(let o=1;o<e.length;o++)if(!/^[a-zA-Z0-9_$]/.test(e[o]))return!1;return!0};if(this.e=function(e){return"("+like(e).join(" AND ")+")"},this.ou=function(e){return"("+like(e).join(" OR ")+")"},this.nao=function(e){return"NOT("+like([e])[0]+")"},void 0!==obj){let separador=",",erro="",retorno=!1;if("object"==typeof obj){let e="",o=!1;for(x in obj)-1==["conteudo","separador","campos"].indexOf(x)&&(e='A chave "'+x+'" não é conhecida');e&&console.warn(e),"string"!=typeof obj.conteudo&&(erro='A chave "conteúdo" deve ser uma string'),(-1==["undefined","string"].indexOf(typeof obj.separador)||"string"==typeof obj.separador&&1!=obj.separador.length)&&(o=!0),erro||(o?erro='A chave "separador", se declarada, deve ser uma string de tamanho 1':separador=obj.separador),erro||(-1==["undefined","object"].indexOf(typeof obj.campos)?o=!0:"object"==typeof obj.campos&&obj.campos.forEach((e=>{"string"==typeof e&&eColuna(e)||(o=!0)})),o?erro='A chave "campos", se declarada, deve ser um array de colunas SQL':campos=obj.campos)}else erro="Parâmetro não declarado corretamente";if(!erro){var texto=obj.conteudo.toLowerCase();if(","!=separador)for(;texto.indexOf(separador)>-1;)texto=texto.replace(separador,",");var funcoes=texto.indexOf("e(")>-1||texto.indexOf("ou(")>-1||texto.indexOf("nao(")>-1,pseudocodigo=funcoes||texto.indexOf(",")>-1||texto.indexOf("=")>-1;funcoes&&(erro=contagem(texto,"(",")","Número desigual de parênteses"),erro||(erro=contagem(texto,"=",",","Termos não declarados corretamente",1)))}if(!erro){texto=texto.replace(/\(/g,"(['").replace(/\)/g,"'])").replace(/,/g,"','");const substituir={",'(['":",","'ou([":"ou(['","'e([":"e(['","'nao([":"nao(['","])'":"])","'ou":"ou","'e":"e","'nao":"nao","''":"'"," ":""};for(x in substituir)for(;texto.indexOf(x)>-1;)texto=texto.replace(x,substituir[x]);texto=texto.replace(/e\(/g,"new ExcelParaSQL().e(").replace(/ou\(/g,"new ExcelParaSQL().ou(").replace(/nao\(/g,"new ExcelParaSQL().nao(");try{for(texto=eval(texto);texto.indexOf("()")>-1;)texto=texto.replace("()","0")}catch(e){if(!pseudocodigo&&campos.length){for(;texto.indexOf("'")>-1;)texto=texto.replace("'","");let e=new Array;campos.forEach((o=>{e.push(o+" LIKE '%"+texto+"%'")})),texto=e.join(" OR ")}else erro="Erro desconhecido"}}return erro?console.error(erro):retorno=texto,retorno}}